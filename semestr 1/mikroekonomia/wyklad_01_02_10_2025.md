## Informacje organizacyjne

* **Prowadzący:** dr Miłosz Rojek (prowadzący wykład), dr hab. Agata Sielska prof. SGH (koordynator przedmiotu) 
* **Forma zajęć:** Zajęcia będą miały charakter wykładowo-ćwiczeniowy. Po części teoretycznej rozwiązywane będą zadania.
* **Prace domowe:** Po każdych zajęciach będą zadawane zadania do samodzielnego rozwiązania w domu, które będą omawiane na początku kolejnego spotkania.
* **Zaliczenie:** Zaliczenie przedmiotu będzie się opierało na:
    * **Trzech zestawach zadań** do samodzielnego rozwiązania.
    * **Modelu ekonometrycznym** (popytu lub podaży), który studenci będą musieli przygotować. Szczegóły dotyczące modelu zostaną przekazane w przyszłości.
* **Egzamin:** Prowadzący nie był pewien, czy przewidziany jest egzamin końcowy i ma to skonsultować z koordynatorką przedmiotu, prof. Sielską. Na ten moment podstawą zaliczenia są wspomniane zestawy zadań i model.
* **Konsultacje:** Możliwe są indywidualne konsultacje po wcześniejszym umówieniu się z prowadzącym.
* **Literatura:** Głównym podręcznikiem, na którym opierają się zajęcia, jest "Advanced Microeconomic Theory" autorstwa Geoffrey A. Jehle i Philip J. Reny.

---

## Model wyboru konsumenta

Teoria wyboru konsumenta stanowi fundament analizy mikroekonomicznej. Jej celem jest stworzenie formalnego, spójnego logicznie modelu, który pozwala opisywać, analizować i przewidywać, w jaki sposób racjonalni decydenci dokonują wyborów w warunkach rzadkości. Model ten, jak każdy model naukowy, jest celowym uproszczeniem rzeczywistości, opartym na precyzyjnie zdefiniowanych założeniach. Jego siła nie leży w dosłownym odzwierciedleniu psychologicznych procesów decyzyjnych, lecz w zdolności do generowania testowalnych hipotez dotyczących obserwowalnych zachowań.

Każdy model ekonomiczny jest **uproszczonym opisem rzeczywistości**, który koncentruje się na najważniejszych aspektach analizowanego zjawiska, pomijając mniej istotne szczegóły. Model wyboru konsumenta, który będziemy analizować, składa się z czterech kluczowych elementów:

1. **Zbiór konsumpcyjny (Consumption Set), $X$**: Reprezentuje on uniwersum wszystkich potencjalnych wyborów. To zbiór wszystkich możliwych opcji, czyli **planów konsumpcji**, które konsument może sobie wyobrazić, niezależnie od tego, czy są dla niego dostępne. Jest to dziedzina naszego modelu. Reprezentuje uniwersum wszystkich możliwych do wyobrażenia alternatyw lub planów konsumpcji. Odpowiada na pytanie: "spomiędzy czego konsument *może* wybierać?". Jest to definicja czysto techniczna, niezależna od jakichkolwiek ograniczeń, z jakimi decydent może się spotkać w rzeczywistości.
2. **Relacja preferencji (Preference Relation), $\succeq$**: Opisuje, w jaki sposób konsument **porównuje i porządkuje** poszczególne alternatywy ze zbioru konsumpcyjnego. Pozwala na uporządkowanie elementów zbioru konsumpcyjnego od najbardziej do najmniej pożądanych. Odpowiada na pytanie: "czego konsument *chce*?".
3. **Zbiór dopuszczalny (Feasible Set), $B$**: Jest to podzbiór zbioru konsumpcyjnego, zawierający tylko te alternatywy, które są dla konsumenta **faktycznie dostępne** przy uwzględnieniu istniejących ograniczeń. Zbiór ten uwzględnia wszelkie ograniczenia – ekonomiczne (np. budżet), instytucjonalne (np. reglamentacja) czy fizyczne. Odpowiada na pytanie: "na co konsumenta *stać*?".
4. **Reguła behawioralna (Behavioral Rule)**:  Określa, **którą z dostępnych alternatyw** konsument ostatecznie wybierze. W standardowej teorii mikroekonomicznej zakłada się, że konsument jest racjonalny i dąży do maksymalizacji swojej satysfakcji (zakłada się, że będzie to alternatywa najlepsza z jego punktu widzenia). Odpowiada na pytanie: "jak agent *wybiera*?".

Ta czteroelementowa struktura stanowi uniwersalny schemat modelowania racjonalnego wyboru. Nie ogranicza się ona wyłącznie do teorii konsumenta. Poprzez odpowiednią reinterpretację poszczególnych komponentów, ten sam logiczny szkielet można zastosować do analizy decyzji innych podmiotów gospodarczych. Na przykład dla firmy, "zbiór konsumpcyjny" staje się "zbiorem produkcyjnym" (wszystkie technologicznie możliwe plany produkcji), "relacja preferencji" zostaje zastąpiona przez kryterium zysku, "zbiór dopuszczalny" jest determinowany przez dostępną technologię, a "reguła behawioralna" to maksymalizacja zysku. Zrozumienie tej ogólnej struktury pozwala dostrzec jedność analityczną leżącą u podstaw różnych gałęzi teorii ekonomii.

---

### 1. Zbiór Konsumpcyjny ($X$)

Zbiór konsumpcyjny to fundament, na którym budujemy całą analizę. To zbiór wszystkich możliwych planów konsumpcji (alternatyw), jakie konsument mógłby wziąć pod uwagę, niezależnie od ich realnej dostępności.

Każdy element tego zbioru, $x \in X$, nazywany jest **koszykiem konsumpcyjnym** (consumption bundle). Koszyk ten jest wektorem $x = (x_1, x_2,..., x_n)$, gdzie $n$ to skończona liczba dóbr w gospodarce, a $x_i$ reprezentuje ilość $i$-tego dobra w koszyku.[1]

#### Założenia dotyczące zbioru konsumpcyjnego:
* **Elementy zbioru**: Elementami są **koszyki dóbr** (towarów i usług).
* **Podzielność dóbr**: Zakładamy, że każde dobro jest **doskonale podzielne**, co oznacza, że można konsumować dowolną jego część (np. 1,5 kg jabłek). Ułatwia to analizę matematyczną, w szczególności stosowanie pochodnych.
* **Ilość dóbr**: Ilość danego dobra $i$ oznaczamy jako $x_i$ i zakładamy, że jest to liczba nieujemna ($x_i \in \mathbb{R}_{+}$), ponieważ ujemna konsumpcja nie ma sensu ekonomicznego.
* **Wymiarowość**: Przyjmujemy, że istnieje skończona liczba $n$ różnych dóbr. Koszyk dóbr jest więc wektorem w n-wymiarowej przestrzeni: $\mathbf{x} = (x_1, x_2, ..., x_n)$. Zbiór konsumpcyjny $X$ jest podzbiorem **nieujemnego ortantu** przestrzeni euklidesowej, $X \subseteq \mathbb{R}_{+}^{n}$. Dla dwóch dóbr ($n=2$) jest to po prostu pierwsza ćwiartka układu współrzędnych.

#### Własności zbioru konsumpcyjnego:
Aby model był spójny matematycznie, zbiór konsumpcyjny $X$ powinien spełniać następujące warunki (wymagania topologiczne):
* **Jest domknięty**: Oznacza to, że zawiera swoje brzegi. Jeśli mamy ciąg koszyków należących do zbioru, to granica tego ciągu również należy do tego zbioru. Ta własność zapobiega sytuacji, w której optymalny wybór byłby "nieskończenie blisko" pewnego koszyka, ale sam ten koszyk byłby poza zbiorem.
* **Jest wypukły**: Jeśli weźmiemy dwa dowolne koszyki ze zbioru $X$, to każdy koszyk będący ich **kombinacją wypukłą** (czyli ich średnią ważoną) również należy do tego zbioru. Jeśli dwa dowolne koszyki $x^1$ i $x^2$ należą do $X$, to każda ich kombinacja wypukła (średnia ważona) $x^t = tx^1 + (1-t)x^2$ dla $t \in $ również należy do $X$. Oznacza to, że zbiór nie ma "dziur" ani "przerw". Jeśli konsumpcja dwóch skrajnych koszyków jest możliwa, to możliwa jest również konsumpcja każdego uśrednionego koszyka leżącego na odcinku, który je łączy.
* **Zawiera wektor zerowy ($\mathbf{0} \in X$)**: Oznacza to, że koszyk zerowy (niekonsumowanie niczego) jest jedną z możliwych do rozważenia alternatyw.

Te techniczne założenia są kluczowe, ponieważ gwarantują, że przestrzeń, w której konsument dokonuje wyboru, jest "dobrze ukształtowana", co jest warunkiem koniecznym dla zastosowania narzędzi optymalizacji. Wypukłość zbioru konsumpcyjnego stanowi naturalną dziedzinę dla funkcji quasi-wklęsłych, które, jak zobaczymy, opisują preferencje konsumenta. Z kolei domkniętość, w połączeniu z ograniczonością wynikającą z ograniczenia budżetowego, tworzy zbiór zwarty. Zgodnie z fundamentalnym twierdzeniem Weierstrassa, każda funkcja ciągła (jak funkcja użyteczności) na zbiorze zwartym osiąga swoje maksimum. A zatem, założenie o domkniętości zbioru konsumpcyjnego jest fundamentalnym krokiem gwarantującym, że problem maksymalizacji użyteczności w ogóle posiada rozwiązanie.

---

### 2. Relacja Preferencji ($\succeq$)

Aby modelować wybór, musimy wiedzieć, jak konsument wartościuje różne koszyki dóbr. Służy do tego **relacja preferencji**, która pozwala na porównywanie alternatyw. Teoria wyboru konsumenta nie zakłada arbitralnie, jakie są preferencje konsumenta. Zamiast tego, buduje je od podstaw, wychodząc z kilku prostych i intuicyjnych założeń, zwanych **aksjomatami**. Aksjomaty te formalizują ideę racjonalnego i spójnego podejmowania decyzji.

Podstawowym narzędziem jest **relacja słabej preferencji**, oznaczana symbolem $\succeq$. Zapis $x^1 \succeq x^2$ czytamy jako: "koszyk $x^1$ jest **nie gorszy niż** (co najmniej tak samo dobry jak) koszyk $x^2$".

Na podstawie relacji słabej preferencji definiujemy dwie inne, bardzo ważne relacje:
1.  **Relacja obojętności ($\sim$)**: Dwa koszyki są dla konsumenta obojętne, jeśli $x^1$ jest nie gorszy od $x^2$ ORAZ $x^2$ jest nie gorszy od $x^1$. Są one dla niego **tak samo dobre**.
    $$x^1 \sim x^2 \iff (x^1 \succeq x^2 \text{ oraz } x^2 \succeq x^1)$$
2.  **Relacja ścisłej preferencji ($\succ$)**: Koszyk $x^1$ jest ściśle preferowany (lepszy) od $x^2$, jeśli $x^1$ jest nie gorszy od $x^2$, ale **nie jest prawdą**, że $x^2$ jest nie gorszy od $x^1$.
    $$x^1 \succ x^2 \iff (x^1 \succeq x^2 \text{ oraz } \neg(x^2 \succeq x^1))$$

#### Aksjomaty preferencji

**Aksjomat 1: Zupełność (Completeness)**
Dla dowolnych dwóch koszyków $x^1$ i $x^2$ ze zbioru konsumpcyjnego, zachodzi relacja $x^1 \succeq x^2$ lub $x^2 \succeq x^1$.

* **Znaczenie**: Konsument jest w stanie porównać każdą parę koszyków. Nie ma sytuacji, w której odpowiedziałby "nie wiem, co wolę". Jest to założenie o zdolności decydenta do oceny.

**Aksjomat 2: Przechodniość**
Dla dowolnych trzech koszyków $x^1, x^2, x^3$, jeśli $x^1 \succeq x^2$ oraz $x^2 \succeq x^3$, to musi zachodzić $x^1 \succeq x^3$.

* **Znaczenie**: Preferencje konsumenta są spójne. Jeśli woli jabłka od gruszek i gruszki od śliwek, to musi też woleć jabłka od śliwek. Narzuca to logiczną spójność preferencji. Wyklucza  cykliczne upodobania (np. wolę A od B, B od C, ale C od A), które uniemożliwiłyby dokonanie jednoznacznego wyboru.

> **Preferencje racjonalne**: Preferencje, które spełniają aksjomaty zupełności i przechodniości, nazywamy **racjonalnymi**. Tylko takie preferencje pozwalają na stworzenie spójnego rankingu (uporządkowania) wszystkich dostępnych alternatyw.

**Aksjomat 3: Ciągłość**
Dla dowolnego koszyka $x$, zbiory koszyków od niego "nie gorszych" ($\succeq(x)$) i "nie lepszych" ($\preceq(x)$) są **zbiorami domkniętymi**.

* **Znaczenie**: Jest to założenie o charakterze technicznym, ale o ważnych konsekwencjach. Wyklucza to "nagłe skoki" w preferencjach. Jeśli mamy ciąg koszyków, z których każdy jest co najmniej tak dobry jak koszyk $x$, i ciąg ten zbiega do pewnego granicznego koszyka $y$, to ten koszyk $y$ również musi być co najmniej tak dobry jak $x$. Ważną implikacją tego aksjomatu jest to, że **krzywe obojętności są ciągłe** i nie mają "dziur".

#### Funkcja Użyteczności ($u(x)$)

##### Twierdzenie Debreu: Od Preferencji do Użyteczności
Połączenie trzech powyższych aksjomatów prowadzi do jednego z najważniejszych wyników w teorii wyboru – **twierdzenia Debreu**.  Mówi ono, że jeśli preferencje konsumenta są racjonalne (zupełne i przechodnie) oraz ciągłe, to można je przedstawić za pomocą **ciągłej funkcji użyteczności** $u(x)$. Jest to funkcja, która każdemu koszykowi dóbr przypisuje liczbę rzeczywistą w taki sposób, że porządek tych liczb odzwierciedla porządek preferencji:

$$x^1 \succeq x^2 \iff u(x^1) \ge u(x^2)$$

Funkcja użyteczności jest narzędziem analitycznym, które przypisuje liczby do koszyków w taki sposób, że porządek tych liczb odzwierciedla porządek preferencji konsumenta. Koszyki bardziej preferowane otrzymują wyższe wartości liczbowe, a koszyki obojętne – te same wartości.

**Znaczenie**: Twierdzenie Debreu uzasadnia całą praktykę mikroekonomii polegającą na formułowaniu funkcji użyteczności i stosowaniu rachunku różniczkowego do znajdowania maksimów. Bez tego twierdzenia teoria wyboru pozostałaby w sferze abstrakcyjnych porządków preferencji, bez możliwości wykorzystania zaawansowanych narzędzi teorii optymalizacji.

**Ważne**: Funkcja użyteczności jest czysto matematycznym konstruktem i ma charakter **porządkowy (ordinalny)**, a nie kardynalny. Konkretne wartości liczbowe użyteczności nie mają znaczenia – liczy się tylko ich kolejność (charakter porządkowy). Stwierdzenie, że $u(x^1) = 20$, a $u(x^2) = 10$ oznacza jedynie, że $x^1 \succ x^2$, a nie że $x^1$ jest "dwa razy lepszy" od $x^2$. Oznacza to, że każda **dodatnia monotoniczna transformacja** (positive monotonic transformation) funkcji użyteczności (np. pomnożenie jej przez 2, dodanie 5, zlogarytmowanie) będzie reprezentować te same preferencje. Jeśli $u(x)$ jest funkcją użyteczności, a $f$ jest dowolną funkcją rosnącą (np. $f(z) = z^3$, $f(z) = \ln(z)$, $f(z) = a \cdot z + b$ dla $a>0$), to nowa funkcja $v(x) = f(u(x))$ również będzie reprezentować tę samą relację preferencji, ponieważ zachowuje ona ten sam porządek wartości.
 
##### Przykład Preferencji Nieciągłych: Preferencje Leksykograficzne

Aby zrozumieć kluczową rolę aksjomatu ciągłości, warto przeanalizować **preferencje leksykograficzne**. Dla dwóch dóbr, konsument o takich preferencjach najpierw porównuje koszyki pod względem ilości dobra 1. Preferuje ten, który ma go więcej - jak słów w słowniku – najpierw wg ilości dobra 1, a dopiero przy remisie wg dobra 2.

Formalnie: $x^1 \succeq x^2 \iff (x_1^1 > x_1^2) \text{ lub } (x_1^1 = x_1^2 \text{ i } x_2^1 \ge x_2^2)$.

Preferencje te są zupełne i przechodnie, ale **nie są ciągłe**. Można to pokazać, konstruując ciąg koszyków, który zbiega do pewnego koszyka, ale preferencje "przeskakują" w granicy. Z powodu braku ciągłości, nie istnieje żadna ciągła funkcja użyteczności, która mogłaby reprezentować preferencje leksykograficzne. To pokazuje, że aksjomat ciągłości jest warunkiem koniecznym dla istnienia takiej funkcji.

#### Dalsze aksjomaty i kształt krzywych obojętności

Krzywa obojętności to zbiór wszystkich koszyków, które dają konsumentowi ten sam poziom zadowolenia (są dla niego obojętne). Formalnie, jest to zbiór obojętności $\sim(x^0)$ lub, w języku funkcji użyteczności, poziomica (warstwica) funkcji $u(x)$ dla danego poziomu użyteczności $\bar{u}$. 

$$\text{Krzywa obojętności} = \{ x \in X \mid u(x) = \bar{u} \}$$

Dodatkowe aksjomaty pozwalają nam określić ich typowy kształt (nie są niezbędne do zdefiniowania racjonalności, ale są standardowymi założeniami, które nadają modelowi większy realizm i zapewniają "dobre zachowanie" krzywych obojętności oraz istnienie jednoznacznych rozwiązań problemu konsumenta). 

**Aksjomat 4: Monotoniczność (Monotonicity)**
Dla każdych $x^1, x^2 \in \mathbb{R}_{+}^{n}$:
    *   Jeśli $x^1 \ge x^2$ (koszyk $x^1$ ma nie mniej każdego dobra niż $x^2$), to $x^1 \succeq x^2$.
    *   Jeśli $x^1 \gg x^2$ (koszyk $x^1$ ma więcej każdego dobra niż $x^2$), to $x^1 \succ x^2$.

* **Znaczenie**: "Więcej znaczy lepiej". Konsument zawsze preferuje koszyk, który zawiera więcej przynajmniej jednego dobra, nie zawierając mniej żadnego innego. 

* **Implikacja**: Krzywe obojętności mają **nachylenie ujemne**. Aby utrzymać ten sam poziom użyteczności, zwiększając ilość jednego dobra, musimy zmniejszyć ilość drugiego.

**Aksjomat 4': Lokalne Nienasycenie (Local Non-satiation, LNS)**
Dla każdego koszyka $x^0 \in \mathbb{R}_{+}^{n}$ i dla dowolnie małej odległości $\epsilon > 0$, istnieje inny koszyk $x$ w tej odległości ($x \in B_{\epsilon}(x^0)$), taki że $x \succ x^0$.

* **Znaczenie**: Jest to słabsza wersja monotoniczności. Mówi ona, że w dowolnie małym otoczeniu każdego koszyka zawsze znajdzie się jakiś inny, lepszy koszyk. Wyklucza to istnienie "punktów błogości" (bliss points) lub "grubych" krzywych obojętności, czyli obszarów, w których konsument jest całkowicie zaspokojony i żadna niewielka zmiana nie może poprawić jego sytuacji. Jest to wystarczające założenie, aby zagwarantować, że konsument wyda cały swój dochód.

**Aksjomat 5: Wypukłość (Convexity)**
Dla każdych $x^1, x^2 \in \mathbb{R}_{+}^{n}$, jeśli $x^1 \succeq x^2$, to dla każdego $t \in $ zachodzi $tx^1 + (1-t)x^2 \succeq x^2$.

* **Znaczenie**: "Średnia jest preferowana względem skrajności". Jeśli konsument jest (słabo) przekonany o wyższości koszyka $x^1$ nad $x^2$, to każdy uśredniony koszyk, leżący na odcinku łączącym $x^1$ i $x^2$, będzie również co najmniej tak samo dobry jak $x^2$. Jeśli weźmiemy dwa koszyki $x^1$ i $x^2$, które leżą na tej samej krzywej obojętności, to każda ich kombinacja wypukła (czyli koszyk "pośredni") będzie co najmniej tak samo dobra jak one.

* **Implikacja**: Geometrycznie oznacza to, że zbiory koszyków preferowanych (górne zbiory konturu) są zbiorami wypukłymi. Krzywe obojętności są **wypukłe względem początku układu współrzędnych** (wygięte "do środka"). Odpowiadającą tej własności cechą funkcji użyteczności jest **quasi-wklęsłość**.

Funkcja $f$ jest quasi-wklęsła, jeśli dla dowolnych $x^1, x^2$ z jej dziedziny, wartość funkcji dla dowolnej kombinacji wypukłej tych punktów jest nie mniejsza niż minimum wartości funkcji w punktach skrajnych: $f(tx^1 + (1-t)x^2) \ge \min\{f(x^1), f(x^2)\}$.[1] Równoważnie, funkcja jest quasi-wklęsła wtedy i tylko wtedy, gdy wszystkie jej zbiory nadwarstwicowe (tj. zbiory $\{x | f(x) \ge y\}$) są wypukłe.

Użycie pojęcia quasi-wklęsłości zamiast prostszej wklęsłości nie jest przypadkowe. Wynika ono z porządkowego charakteru użyteczności. Wklęsłość jest własnością kardynalną – nie jest zachowywana przy dodatnich transformacjach monotonicznych (np. funkcja $u(x) = \sqrt{x}$ jest wklęsła, ale $v(x) = (u(x))^4 = x^2$ już nie jest). Natomiast quasi-wklęsłość jest własnością porządkową – każda monotoniczna transformacja funkcji quasi-wklęsłej jest również quasi-wklęsła. Ponieważ preferencje są niezmiennicze względem takich transformacji, odpowiadająca im własność funkcji użyteczności również musi być niezmiennicza. Quasi-wklęsłość jest właśnie tą własnością, co czyni ją odpowiednim matematycznym narzędziem do opisu wypukłych preferencji.

**Aksjomat 5': Ścisła Wypukłość (Strict Convexity)**

Dla każdych $x^1, x^2 \in \mathbb{R}_{+}^{n}$ takich, że $x^1 \neq x^2$, jeśli $x^1 \succeq x^2$, to dla każdego $t \in (0,1)$ zachodzi $tx^1 + (1-t)x^2 \succ x^2$.

* **Znaczenie**: Jest to silniejsza wersja wypukłości, która mówi, że średnia jest *ściśle* preferowana od gorszej ze skrajności. Wyklucza to istnienie płaskich fragmentów na krzywych obojętności. To założenie jest kluczowe dla zapewnienia, że problem maksymalizacji użyteczności będzie miał jednoznaczne, unikalne rozwiązanie.

### Podsumowanie Aksjomatów Preferencji i ich Implikacji

Poniższa tabela syntetyzuje omówione aksjomaty, ich formalne definicje, intuicyjne znaczenie oraz kluczowe konsekwencje dla modelu wyboru konsumenta.

| Aksjomat | Definicja Formalna | Znaczenie Intuicyjne | Główne Implikacje |
| :--- | :--- | :--- | :--- |
| **Zupełność** | $\forall x^1, x^2 \in X: x^1 \succeq x^2 \text{ lub } x^2 \succeq x^1$ | Konsument potrafi porównać każdą parę koszyków. | Umożliwia stworzenie rankingu alternatyw. |
| **Przechodniość** | $\forall x^1, x^2, x^3 \in X: (x^1 \succeq x^2 \land x^2 \succeq x^3) \implies x^1 \succeq x^3$ | Preferencje są logicznie spójne; brak cyklicznych wyborów. | W połączeniu z zupełnością definiuje racjonalność. |
| **Ciągłość** | Zbiory $\succeq(x)$ i $\preceq(x)$ są domknięte. | Małe zmiany w koszyku nie powodują "skokowych" zmian w preferencjach. | Gwarantuje istnienie ciągłej funkcji użyteczności (Twierdzenie Debreu). |
| **Monotoniczność** | $x^1 \ge x^2 \implies x^1 \succeq x^2$ i $x^1 \gg x^2 \implies x^1 \succ x^2$ | "Więcej znaczy lepiej". Konsument zawsze preferuje koszyk, który zawiera więcej przynajmniej jednego dobra, nie zawierając mniej żadnego innego. | Krzywe obojętności mają nachylenie ujemne. Konsument wydaje cały dochód. |
| **Wypukłość** | $x^1 \succeq x^2 \implies tx^1 + (1-t)x^2 \succeq x^2$ dla $t \in $ | "Średnie są preferowane (nie gorsze) od skrajności". Jeśli konsument jest (słabo) przekonany o wyższości koszyka $x^1$ nad $x^2$, to każdy uśredniony koszyk, leżący na odcinku łączącym $x^1$ i $x^2$, będzie również co najmniej tak samo dobry jak $x^2$. | Krzywe obojętności są wypukłe względem początku układu (malejący MRS). |
| **Ścisła Wypukłość** | $x^1 \succeq x^2, x^1 \neq x^2 \implies tx^1 + (1-t)x^2 \succ x^2$ dla $t \in (0,1)$ | "Średnie są *ściśle* preferowane od skrajności". | Gwarantuje unikalność optymalnego koszyka (brak płaskich odcinków na krzywych obojętności). |

#### Krańcowa stopa substytucji (MRS)

Nachylenie krzywej obojętności w danym punkcie ma kluczową interpretację ekonomiczną. Jego wartość bezwzględną nazywamy **krańcową stopą substytucji (MRS - Marginal Rate of Substitution)**.

$$MRS(x_1, x_2) = \left| \frac{dx_2}{dx_1} \right| = \frac{MU_1}{MU_2}$$

gdzie $MU_1 = \frac{\partial u}{\partial x_1}$ i $MU_2 = \frac{\partial u}{\partial x_2}$ to **użyteczności krańcowe** dobra 1 i 2.

* **Interpretacja**: MRS mówi nam, z ilu jednostek dobra 2 konsument jest skłonny zrezygnować, aby otrzymać jedną dodatkową jednostkę dobra 1, pozostając na tym samym poziomie zadowolenia. 
* **Malejąca MRS**: Przy założeniu wypukłości preferencji, MRS maleje w miarę przesuwania się w dół po krzywej obojętności. Jest to intuicyjne odzwierciedlenie preferencji dla zróżnicowanej konsumpcji(im więcej mamy dobra 1, tym mniej dobra 2 jesteśmy skłonni za nie oddać).

##### Wyprowadzenie Matematyczne MRS
Aby wyprowadzić wzór na MRS, rozważmy różniczkę zupełną funkcji użyteczności $u(x_1, x_2)$ wzdłuż krzywej obojętności, gdzie $u(x_1, x_2) = \bar{u}$ (stała). Zmiana użyteczności $du$ musi być równa zero:

$$ du = \frac{\partial u(x_1, x_2)}{\partial x_1} dx_1 + \frac{\partial u(x_1, x_2)}{\partial x_2} dx_2 = 0 $$

Wyrażenie $\frac{\partial u}{\partial x_i}$ to **użyteczność krańcowa** (marginal utility, $MU_i$) z konsumpcji $i$-tego dobra. Równanie można zatem zapisać jako:

$$MU_1 dx_1 + MU_2 dx_2 = 0$$

Przekształcając, otrzymujemy nachylenie krzywej obojętności:

$$\frac{dx_2}{dx_1} = - \frac{MU_1(x_1, x_2)}{MU_2(x_1, x_2)}$$

Krańcowa stopa substytucji jest wartością bezwzględną tego nachylenia [1]:

$$MRS(x_1, x_2) \equiv \left| \frac{dx_2}{dx_1} \right| = \frac{MU_1(x_1, x_2)}{MU_2(x_1, x_2)}$$


---

### 3. Zbiór dopuszczalny i ograniczenie budżetowe

Konsument nie może wybrać dowolnego koszyka – jego wybory są ograniczone, przede wszystkim przez dochód i ceny dóbr. **Zbiór dopuszczalny** ($B$) to podzbiór zbioru konsumpcyjnego ($X$), który zawiera wszystkie alternatywy faktycznie osiągalne dla konsumenta, po uwzględnieniu wszelkich ograniczeń (np. budżetowych, czasowych, prawnych).

Najważniejszym ograniczeniem w standardowym modelu rynkowym jest **ograniczenie budżetowe**. Zakłada się, że konsument jest cenobiorcą, czyli nie ma wpływu na ceny rynkowe dóbr, $p = (p_1,..., p_n)$, które są dla niego stałe i dodatnie ($p_i > 0$). Dysponuje on również określonym dochodem pieniężnym, $y$. Ograniczenie budżetowe mówi, że całkowite wydatki na dobra nie mogą przekroczyć dochodu:

$$\sum_{i=1}^{n} p_i x_i \le y \quad \text{lub w notacji wektorowej:} \quad p \cdot x \le y$$ 

#### Zbiór Budżetowy i Linia Budżetu
**Zbiór budżetowy ($B$)** to zbiór wszystkich koszyków konsumpcyjnych, które spełniają ograniczenie budżetowe (takie na które stać konsumenta przy danym wektorze cen $p \gg 0$ i dochodzie $y > 0$)

$$B = \{ x \in \mathbb{R}_{+}^{n} p \cdot x \le y \}$$

Zbiór budżetowy jest wypukły (ponieważ jest zdefiniowany przez liniową nierówność) i domknięty. Dla dodatnich cen i dochodu jest on również ograniczony. Zbiór, który jest jednocześnie domknięty i ograniczony, nazywa się **zbiorem zwartym (compact)**.

Zewnętrzną granicę zbioru budżetowego tworzą koszyki, na które konsument wydaje cały swój dochód. Ta granica nazywana jest **linią budżetu** (dla dwóch dóbr) lub hiperpłaszczyzną budżetową (dla $n>2$) i jest opisana równaniem:

$$p \cdot x = y$$

#### Nachylenie Linii Budżetu i Statyka Porównawcza
Dla przypadku dwóch dóbr, równanie linii budżetu to $p_1 x_1 + p_2 x_2 = y$. Można je przekształcić do postaci $x_2 = \frac{y}{p_2} - \frac{p_1}{p_2} x_1$. Z tej postaci widać, że **nachylenie linii budżetu** wynosi $-\frac{p_1}{p_2}$. Wartość bezwzględna tego nachylenia, $\frac{p_1}{p_2}$, reprezentuje obiektywny, rynkowy stosunek wymiany obu dóbr. Mówi on, z ilu jednostek dobra 2 należy zrezygnować, aby móc kupić jedną dodatkową jednostkę dobra 1 przy danym dochodzie i cenach. Inna interpretacja to rynkowa stopa wymiany – ile jednostek dobra 2 rynek "wycenia" jako równowartość jednej jednostki dobra 1.

Położenie linii budżetu zmienia się wraz ze zmianami parametrów:
* **Zmiany dochodu ($y$)** powodują równoległe przesunięcie linii budżetu (na zewnątrz przy wzroście, do wewnątrz przy spadku). Wzrost dochodu do $y' > y$ powoduje równoległe przesunięcie linii budżetu na zewnątrz, nie zmieniając jej nachylenia. Zbiór budżetowy powiększa się.
* **Zmiany cen ($p_i$)** powodują zmianę nachylenia linii budżetu (obrót wokół jednego z punktów przecięcia z osiami). Wzrost ceny dobra 1 do $p_1' > p_1$ powoduje rotację linii budżetu do wewnątrz wokół punktu przecięcia z osią $x_2$. Nachylenie linii budżetu staje się bardziej strome (wartość bezwzględna rośnie). Zbiór budżetowy kurczy się.

---

### 4. Reguła behawioralna: Maksymalizacja użyteczności

Centralnym punktem teorii konsumenta jest sformułowanie i rozwiązanie problemu wyboru optymalnego koszyka dóbr przy danych ograniczeniach.

Zakładamy, że racjonalny konsument, stojąc przed wyborem spośród dostępnych dla niego koszyków (ze zbioru budżetowego), wybierze najlepszy (najbardziej preferowany) - ten, który da mu **najwyższy poziom użyteczności**.

**Zadanie Maksymalizacji Użyteczności (Utility Maximization Problem - UMP)** polega na znalezieniu takiego koszyka $x^*$, który maksymalizuje funkcję użyteczności $u(x)$, pod warunkiem że koszyk ten należy do zbioru budżetowego. Formalny zapis problemu jest następujący:

$$\max_{x \ge 0} u(x) \quad \text{p.w. (pod warunkiem)} \quad p \cdot x \le y$$

Model wyboru konsumenta jest skonstruowany w taki sposób, aby istnienie rozwiązania tego problemu było zagwarantowane. Kluczową rolę odgrywa tu **Twierdzenie Weierstrassa**, które stanowi, że każda funkcja ciągła, określona na niepustym zbiorze zwartym, osiąga na tym zbiorze swoje maksimum i minimum. W problemie UMP:
1.  Aksjomat ciągłości preferencji gwarantuje, że funkcja użyteczności $u(x)$ jest ciągła.
2.  Zbiór budżetowy $B$ jest zbiorem zwartym (domkniętym i ograniczonym).
Wszystkie warunki twierdzenia Weierstrassa są zatem spełnione, co gwarantuje, że rozwiązanie problemu maksymalizacji użyteczności zawsze istnieje.

Rozwiązanie tego problemu, $x^*$, jest optymalnym planem konsumpcji dla konsumenta przy danych cenach $p$ i dochodzie $y$. Rozwiązanie UMP wymaga zastosowania metod optymalizacji warunkowej. Wybór metody zależy od charakteru ograniczeń.

#### Matematyczne Metody Rozwiązania

Rozwiązanie UMP wymaga zastosowania metod optymalizacji warunkowej. Wybór metody zależy od charakteru ograniczeń.

##### Uproszczenie Ograniczenia
Jeśli przyjmiemy założenie o monotoniczności preferencji (lub słabsze o lokalnym nienasyceniu), konsument zawsze będzie chciał wydać cały swój dochód. Każdy koszyk, na który wydano by mniej niż $y$, jest gorszy od innego dostępnego koszyka, na który wydano by nieco więcej (np. zawierającego odrobinę więcej każdego z dóbr). W takim przypadku nierównościowe ograniczenie budżetowe $p \cdot x \le y$ staje się w optimum **ograniczeniem wiążącym (napiętym)**, czyli równością $p \cdot x = y$. To upraszcza problem do optymalizacji z ograniczeniem równościowym.

##### Metoda Mnożników Lagrange'a
Dla problemu z ograniczeniem równościowym, standardowym narzędziem jest metoda mnożników Lagrange'a. Polega ona na skonstruowaniu nowej funkcji, zwanej **funkcją Lagrange'a** ($\mathcal{L}$), która łączy funkcję celu z warunkiem ograniczającym [1, 1]:

$$\mathcal{L}(x, \lambda) = u(x) - \lambda(p \cdot x - y)$$

Zmienna $\lambda$ to mnożnik Lagrange'a. Problem warunkowy został przekształcony w problem znalezienia punktu stacjonarnego (ekstremum) funkcji $\mathcal{L}$ bez ograniczeń. **Warunki konieczne pierwszego rzędu (First-Order Conditions - FOCs)** dla maksimum wewnętrznego uzyskuje się poprzez przyrównanie do zera pochodnych cząstkowych funkcji $\mathcal{L}$ względem każdej zmiennej decyzyjnej ($x_i$) oraz mnożnika $\lambda$ [1, 1]:

1.  $\frac{\partial \mathcal{L}}{\partial x_i} = \frac{\partial u(x)}{\partial x_i} - \lambda p_i = 0 \quad$ dla każdego dobra $i=1,..., n$
2.  $\frac{\partial \mathcal{L}}{\partial \lambda} = y - p \cdot x = 0$

Z pierwszego zestawu warunków wynika, że $\frac{\partial u / \partial x_i}{p_i} = \lambda$. Ponieważ $\lambda$ jest stałe dla całego problemu, oznacza to, że w optimum użyteczność krańcowa ostatniej wydanej złotówki musi być taka sama dla każdego dobra. Jest to tzw. **drugie prawo Gossena**.

Łącząc warunki dla dwóch dowolnych dóbr, $i$ oraz $k$, otrzymujemy kluczowy warunek optymalności:

$$ \frac{\partial u / \partial x_i}{\partial u / \partial x_k} = \frac{p_i}{p_k} \implies \frac{MU_i}{MU_k} = \frac{p_i}{p_k} \implies MRS_{ik} = \frac{p_i}{p_k} $$

Warunek ten ma fundamentalną interpretację ekonomiczną: w punkcie optimum, subiektywna stopa wyceny dóbr przez konsumenta (MRS) musi być równa obiektywnej, rynkowej stopie wymiany (stosunkowi cen). Jest to matematyczny zapis geometrycznego warunku styczności krzywej obojętności z linią budżetu.[1]

##### Warunki Kuhna-Tuckera
Metoda Lagrange'a jest skuteczna dla rozwiązań wewnętrznych. Jednakże konsument może optymalnie wybrać zerową ilość jednego lub więcej dóbr (tzw. **rozwiązanie brzegowe**). Bardziej ogólnym podejściem, które obejmuje zarówno rozwiązania wewnętrzne, jak i brzegowe, jest metoda oparta na **warunkach Kuhna-Tuckera (K-T)**. Uwzględnia ona explicite ograniczenia nierównościowe, takie jak $x_i \ge 0$.[1, 1]

Warunki K-T dla UMP (w uproszczonej formie) wymagają, aby dla każdego dobra $i$ w optimum $x^*$ zachodziły następujące relacje:

$$ \frac{\partial u(x^*)}{\partial x_i} - \lambda p_i \le 0, $$
$$ x_i^* \ge 0, $$
$$ x_i^* \left ( \frac{\partial u(x^*)}{\partial x_i} - \lambda p_i \right ) = 0 $$

Ostatni warunek, znany jako **warunek komplementarności (complementary slackness)**, jest kluczowy. Mówi on, że jeśli optymalna konsumpcja dobra $i$ jest dodatnia ($x_i^* > 0$), to warunek $\frac{\partial u}{\partial x_i} - \lambda p_i$ musi być równy zeru (jak w metodzie Lagrange'a). Jeśli natomiast w optimum warunek ten jest nierównością ostrą ($\frac{\partial u}{\partial x_i} < \lambda p_i$), to optymalna konsumpcja tego dobra musi być równa zero ($x_i^* = 0$). Intuicyjnie, jeśli przy zerowej konsumpcji krańcowa użyteczność z pierwszej wydanej złotówki na dobro $i$ jest wciąż niższa niż na inne dobra, konsument nie powinien w ogóle kupować tego dobra.[1]

#### Popyt Marshalla

Optymalny koszyk, czyli **popyt Marshalla**, oznaczony jako $\mathbf{x}^*(p, y)$, to ten, który maksymalizuje użyteczność przy danym ograniczeniu budżetowym. Jeśli preferencje są "dobrze ukształtowane" (w szczególności ściśle wypukłe), rozwiązanie to będzie jednoznaczne i będzie charakteryzowało się **punktem styczności** najwyższej możliwej do osiągnięcia krzywej obojętności z linią budżetu.

W punkcie tym nachylenie krzywej obojętności jest równe nachyleniu linii budżetu. Matematycznie, warunek ten sprowadza się do równości:
$$MRS = \frac{MU_1}{MU_2} = \frac{p_1}{p_2}$$
**Interpretacja ekonomiczna**: W punkcie optimum, subiektywna stopa wymiany dóbr przez konsumenta (MRS) jest równa obiektywnej, rynkowej stopie wymiany (stosunkowi cen). Gdyby tak nie było, konsument mógłby zwiększyć swoją użyteczność, zmieniając strukturę konsumpcji. 

##### Funkcja popytu Marshalla

Rozwiązanie zadania maksymalizacji użyteczności, czyli optymalny koszyk $x^*$, zależy od parametrów zewnętrznych problemu: wektora cen $p$ oraz dochodu $y$. Funkcja, która przyporządkowuje wartościom parametrów $(p, y)$ optymalny koszyk dóbr $x^*$, nazywana jest **funkcją popytu Marshalla** (lub popytem zwykłym) i oznaczana jako $x(p, y)$.

$$x(p, y) = \arg\max_{x} \{ u(x) \mid p \cdot x \le y \}$$

*   **Jednorodność stopnia zero:** Popyt Marshalla jest jednorodny stopnia zero względem cen i dochodu, tzn. $x(tp, ty) = x(p, y)$ dla dowolnego $t > 0$. Oznacza to, że proporcjonalna zmiana wszystkich cen i dochodu (np. z powodu inflacji) nie zmienia realnych możliwości nabywczych konsumenta i, co za tym idzie, jego optymalnego wyboru.[8]
*   **Ciągłość:** Jeśli preferencje są ściśle wypukłe, funkcja popytu Marshalla jest funkcją ciągłą.

Funkcja ta jest końcowym produktem modelu i pozwala przewidywać, jak zmienią się wybory konsumenta w odpowiedzi na zmiany cen i dochodu (dla każdego dobra $i$ określa ilość $x_i(p, y)$, jaką konsument zdecyduje się kupić przy danym układzie cen i dochodzie).

#### Przykład: Wyprowadzenie Popytu dla Funkcji Użyteczności CES
Jako ilustrację zastosowania całego aparatu teoretycznego, przeanalizujmy wyprowadzenie funkcji popytu dla funkcji użyteczności o stałej elastyczności substytucji (CES) postaci $u(x_1, x_2) = (x_1^\rho + x_2^\rho)^{1/\rho}$, gdzie $0 \neq \rho < 1$.[1]

1.  **Problem:**
    $$\max_{(x_1, x_2)} (x_1^\rho + x_2^\rho)^{1/\rho} \quad \text{p.w.} \quad p_1 x_1 + p_2 x_2 = y$$

2.  **Funkcja Lagrange'a:**
    $$\mathcal{L}(x_1, x_2, \lambda) = (x_1^\rho + x_2^\rho)^{1/\rho} - \lambda(p_1 x_1 + p_2 x_2 - y)$$

3.  **Warunki Pierwszego Rzędu:**
    *   $\frac{\partial \mathcal{L}}{\partial x_1} = \frac{1}{\rho} (x_1^\rho + x_2^\rho)^{(1/\rho)-1} (\rho x_1^{\rho-1}) - \lambda p_1 = 0$
    *   $\frac{\partial \mathcal{L}}{\partial x_2} = \frac{1}{\rho} (x_1^\rho + x_2^\rho)^{(1/\rho)-1} (\rho x_2^{\rho-1}) - \lambda p_2 = 0$
    *   $\frac{\partial \mathcal{L}}{\partial \lambda} = y - p_1 x_1 - p_2 x_2 = 0$

4.  **Rozwiązanie:** Dzieląc pierwsze równanie przez drugie, eliminujemy $\lambda$ i wspólny człon z funkcją użyteczności, co prowadzi do warunku styczności:
    
    $$\frac{x_1^{\rho-1}}{x_2^{\rho-1}} = \frac{p_1}{p_2}$$
    
    Co można przepisać jako:
    
    $$\left(\frac{x_1}{x_2}\right)^{\rho-1} = \frac{p_1}{p_2}$$

5.  **Wyznaczenie funkcji popytu:** Z powyższego warunku wyznaczamy $x_1$ jako funkcję $x_2$ (lub odwrotnie), wstawiamy do równania budżetowego i po serii przekształceń algebraicznych otrzymujemy jawne postaci funkcji popytu Marshalla na oba dobra [1]:
    $$x_1(p_1, p_2, y) = \frac{p_1^{1/(\rho-1)}}{p_1^{\rho/(\rho-1)} + p_2^{\rho/(\rho-1)}} y$$   $$x_2(p_1, p_2, y) = \frac{p_2^{1/(\rho-1)}}{p_1^{\rho/(\rho-1)} + p_2^{\rho/(\rho-1)}} y$$

Te funkcje dokładnie określają, jak optymalna ilość każdego dobra zależy od jego ceny, ceny drugiego dobra oraz dochodu konsumenta, stanowiąc końcowy produkt całego modelu wyboru. Analiza własności tych funkcji (np. ich pochodnych względem cen i dochodu) jest przedmiotem dalszych badań w teorii popytu.
