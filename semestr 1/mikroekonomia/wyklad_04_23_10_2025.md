# Informacje organizacyjne

## Zaliczenie (Informacje ogólne)

Zaliczenie tej części zajęć składać się będzie z kilku komponentów:

1.  **Projekt (Model Estymacji):** Oszacowanie modelu ekonometrycznego.
2.  **Prezentacja (Esencja Artykułu):** Przygotowanie krótkiego omówienia wybranego artykułu naukowego.
3.  **Zadania od dr Rojka:** (Wspomniane jako odrębny element).
4.  **Esej (Status niepewny):** Prowadząca musi jeszcze potwierdzić, czy esej obowiązuje. Sugeruje jednak "szykować się na to", że trzeba będzie napisać "parę stron na jakiś tam temat w oparciu o literaturę". Kwestia ta ma być wyjaśniona na następnych zajęciach.

Egzamin końcowy (planowany za rok) jest na zasadzie "zdał" lub "nie zdał".

---

## Szczegóły Projektu (Model Estymacji)

* **Temat:** Należy oszacować model popytowy (preferowany model AIDS) lub funkcję produkcji, bazując na rzeczywistych danych.
* **Elastyczność:** Tematyka jest **dowolna**. Istnieje możliwość rezygnacji z danych rzeczywistych na rzecz np. danych sztucznych, pod warunkiem dodania "fajerwerków" (np. sprawdzenie stabilności oszacowań) jako wkładu własnego. W razie wątpliwości temat można skonsultować mailowo lub na Teams.
* **Forma:** Krótki raport.
* **Zawartość raportu:** Raport powinien zawierać:
    * Krótki opis zagadnienia.
    * Opis zastosowanego modelu (funkcja, zmienne) i metody estymacji.
    * Wyniki.
    * Interpretację wyników.
    * Wnioski.
* **Tryb:** Projekt przygotowywany jest **indywidualnie**.
* **Termin:** **20 stycznia**.
* **Wysyłka:** Projekt należy przesłać mailem lub przez Teams.

---

## Szczegóły Prezentacji (Esencja Artykułu)

* **Zadanie:** Przygotowanie krótkiego omówienia ("esencji") wybranego artykułu naukowego.
* **Tematyka:** Artykuły dotyczą systemów popytowych (udostępnione na Teams) lub funkcji produkcji (materiały pojawią się w grudniu).
* **Forma:** Prezentacja lub plik tekstowy z podsumowaniem (w "formie trwałej") do udostępnienia grupie na Teams.
* **Cel:** Przedstawienie kluczowych tez i myśli przewodniej artykułu.
* **Termin:** Elastyczny. Można przygotować prezentację na **następne zajęcia (za tydzień)** lub poczekać na tematy z funkcji produkcji i przygotować ją na **grudzień**.

---

## Forma Zajęć

* Zajęcia mają charakter warsztatowy z wykorzystaniem oprogramowania **R** (i RStudio).
* Omawiane są koncepcje teoretyczne (np. preferencje Gormana, model Stone'a (LES), model Deatona-Muellbauera (AIDS)).
* Następnie pokazywane są praktyczne implementacje w R przy użyciu pakietów (np. `micEconAids`, `systemfit`).
* Część materiału omawia prowadząca, a część doktoranci (w formie prezentacji artykułów).
* Wszystkie materiały (pliki Word, prezentacje) będą udostępniane na kanale w **MS Teams**.
* **Kod do zespołu Teams:** `5L4 SCT`.

---

## Zadania na Następne Zajęcia (za tydzień)

1.  **Wybór artykułu:** Osoby, które chcą zaprezentować artykuł o systemach popytowych "za tydzień", powinny zgłosić swój wybór na kanale Teams **do poniedziałku**.
2.  **Instalacja pakietu:** Należy pobrać i zainstalować pakiet R o nazwie **`systemfit`** (będzie używany do regresji SUR).

---

## Pytania które mogą się pojawić na egzaminie

Prowadząca wspomniała o następujących koncepcjach jako potencjalnych tematach pytań egzaminacyjnych:

### 1. Homogeniczność funkcji popytu

* **Pytanie:** Sprawdź (i uzasadnij słownie), jakiego stopnia homogeniczna jest funkcja popytu, jeśli konsument nie podlega iluzji pieniądza.
* **Komentarz prowadzącej:** "W sumie takie, takie coś to jest banał, ale podejrzewam, że takie coś to na egzaminie już potencjalnie mogę dać... No i też krótkie uzasadnienie słowne, tak? Czyli że... ta funkcja to wynika z maksymalizacji... przy ograniczeniu budżetowym".


## 2. Forma Gormana: Ścieżka Ekspansji Dochodowej

* **Pytanie:** Pokaż, że dla preferencji Gormana (Gorman polar form) ścieżka ekspansji dochodowej jest linią prostą.
* **Komentarz prowadzącej:** To zadanie polegałoby na wyprowadzeniu funkcji popytu z pośredniej funkcji użyteczności $v_i(p, w_i) = a_i(p) + b(p) w_i$ (używając tożsamości Roy'a), a następnie policzeniu pochodnej po dochodzie ($w_i$), aby pokazać, że wynik jest niezależny od dochodu (a także od konsumenta $i$). Prowadząca, wskazując na to wyprowadzenie, stwierdziła: "O takie coś też mogę [zapytać]".


## 3. Forma Gormana: Agregacja Popytu

* **Pytanie:** Pokaż, że jeśli konsumenci (np. dwóch) mają preferencje Gormana, to ich zagregowany popyt również ma formę Gormana i zależy od zagregowanego dochodu, a nie od jego dystrybucji.
* **Komentarz prowadzącej:** To jest zadanie, które – jak wspomniała – **już pojawiło się na egzaminie**. "No i słuchajcie, no i to jest coś, o co zapytałam właśnie w tym roku, tak? Czyli trzeba było pokazać, że [dla] konsumentów, którzy mają te preferencje Gormana, no to zagregowany popyt też będzie można przedstawić jako formę Gormana".


---

# Wykład: Modele popytowe

---

## 1. Wprowadzenie: Problem Agregacji Popytu

Centralnym zagadnieniem wykładu jest problem sumowania (agregacji) popytów indywidualnych w celu uzyskania funkcji popytu rynkowego. Celem jest znalezienie warunków, przy których ten zagregowany popyt "ma sens", tzn. zachowuje się spójnie i racjonalnie, tak jakby pochodził od jednego, reprezentatywnego konsumenta (np. spełniał Słaby Aksjomat Ujawnionych Preferencji).

Aby to osiągnąć, należy odpowiedzieć na dwa fundamentalne pytania:
1.  **Czy zagregowany popyt zależy wyłącznie od całkowitego majątku (agregatu), czy również od jego podziału (dystrybucji) między konsumentów?** Z praktycznego punktu widzenia, badacze rzadko dysponują danymi o dystrybucji, zazwyczaj znany jest tylko agregat.
2.  **Czy popyt zagregowany można modelować tak, jakby pochodził od jednego, "reprezentatywnego konsumenta"?**

---

## 2. Właściwości Preferencji: Homogeniczność i Homotetyczność

Zrozumienie agregacji wymaga analizy właściwości funkcji użyteczności i popytu.

### Funkcje Homogeniczne (Jednorodne)
Funkcja $f(x_1, ..., x_n)$ jest homogeniczna (jednorodna) stopnia $k$, jeżeli dla dowolnej stałej $a > 0$ zachodzi:
$f(ax_1, ..., ax_n) = a^k \cdot f(x_1, ..., x_n)$

W teorii konsumenta kluczowe jest założenie o **braku iluzji pieniądza**. Oznacza ono, że jeśli wszystkie ceny ($p$) oraz dochód ($w$) zostaną pomnożone przez tę samą stałą $a$, optymalny koszyk dóbr ($D$) nie ulegnie zmianie. Dzieje się tak, ponieważ ograniczenie budżetowe $\sum (ap_i)x_i \le (aw)$ jest tożsame z $\sum p_i x_i \le w$.

Wynika z tego fundamentalna właściwość funkcji popytu:
$D(ap_1, ..., ap_n, aw) = D(p_1, ..., p_n, w)$
Oznacza to, że funkcja popytu jest **homogeniczna stopnia zerowego** (ponieważ $a^0 = 1$).

Geometrycznie, preferencje, które można opisać funkcją homogeniczną, charakteryzują się **prostymi ścieżkami ekspansji dochodowej** oraz krańcową stopą substytucji (MRS) stałą wzdłuż promieni wychodzących z początku układu współrzędnych.

### Funkcje Homotetyczne
Preferencje homotetyczne są uogólnieniem preferencji homogenicznych, lepiej dostosowanym do porządkowej teorii użyteczności.

Preferencje są homotetyczne, jeśli można je reprezentować przez funkcję użyteczności $U(x)$, która jest jednorodna stopnia 1 ($U(\alpha x) = \alpha U(x)$). Właściwość ta implikuje kluczowe cechy dla popytu i pośredniej funkcji użyteczności:
1.  **Popyt:** Funkcja popytu $x(p, w)$ jest liniowa (homogeniczna stopnia 1) względem dochodu: $x(p, \alpha w) = \alpha x(p, w)$.
2.  **Pośrednia funkcja użyteczności:** Funkcja $v(p, w)$ musi przyjmować specyficzną postać addytywną względem dochodu: $v(p, w) = a(p) + w$.

Wykładowczyni zademonstrowała to na przykładzie funkcji Cobba-Douglasa $U = x_1^a x_2^{1-a}$, która jest jednorodna stopnia 1. Wyprowadzone z niej funkcje popytu $x_1 = \frac{aw}{p_1}$ i $x_2 = \frac{w(1-a)}{p_2}$ są w sposób oczywisty liniowe względem dochodu $w$.

---

## 3. Rozwiązanie Problemu Agregacji: Preferencje Gormana

Preferencje Gormana dostarczają ścisłych warunków, przy których agregacja popytu jest możliwa i zależy wyłącznie od sumy dochodów, a nie ich podziału.

### Warunek Agregacji
Agregacja $X = \sum x_i$ jest niezależna od dystrybucji dochodów $(w_1, ..., w_I)$ wtedy i tylko wtedy, gdy przesunięcie dochodu między dwoma dowolnymi konsumentami $i$ oraz $j$ (przy stałej sumie $W$) nie zmienia zagregowanego popytu na żadne dobro $l$.

Wymaga to, aby **krańcowa skłonność do konsumpcji (pochodna popytu względem dochodu) była identyczna dla wszystkich konsumentów**:
$\frac{\partial x_{li}(p, w_i)}{\partial w_i} = \frac{\partial x_{lj}(p, w_j)}{\partial w_j} \quad$ dla wszystkich $i, j, l$.

Geometrycznie oznacza to, że **ścieżki ekspansji dochodowej wszystkich konsumentów muszą być liniami prostymi i wzajemnie równoległymi**.

### Twierdzenie Gormana (Gorman Polar Form)
Powyższy warunek jest spełniony wtedy i tylko wtedy, gdy pośrednia funkcja użyteczności każdego konsumenta $i$ ma specyficzną postać, znaną jako **Forma Gormana** (Gorman Polar Form):

$v_i(p, w_i) = a_i(p) + b(p) \cdot w_i$

* $a_i(p)$ jest składnikiem specyficznym dla konsumenta $i$ (odzwierciedla różne gusta).
* $b(p)$ jest funkcją **wspólną dla wszystkich konsumentów** i jest to kluczowe założenie.

### Wyprowadzenie i Wnioski
**1. Ścieżki ekspansji:**
Używając tożsamości Roy'a do znalezienia popytu na dobro $n$:
$x_{in}(p, w_i) = - \frac{\partial v_i / \partial p_n}{\partial v_i / \partial w_i}$

Obliczając pochodne formy Gormana:
* $\frac{\partial v_i}{\partial p_n} = \frac{\partial a_i(p)}{\partial p_n} + \frac{\partial b(p)}{\partial p_n} w_i$
* $\frac{\partial v_i}{\partial w_i} = b(p)$

Otrzymujemy funkcję popytu:
$x_{in}(p, w_i) = - \frac{\frac{\partial a_i}{\partial p_n} + \frac{\partial b}{\partial p_n} w_i}{b(p)} = - \frac{1}{b(p)}\frac{\partial a_i}{\partial p_n} - \left[ \frac{1}{b(p)}\frac{\partial b}{\partial p_n} \right] w_i$

Teraz, licząc krańcową skłonność do konsumpcji dobra $n$:
$\frac{\partial x_{in}}{\partial w_i} = - \frac{1}{b(p)}\frac{\partial b}{\partial p_n}$

Wynik ten jest **niezależny od $w_i$** (co oznacza liniowe ścieżki ekspansji) oraz **niezależny od $i$** (ponieważ zależy tylko od wspólnej funkcji $b(p)$, co oznacza równoległe ścieżki). Warunek agregacji jest spełniony.

**2. Agregacja:**
Sumując popyty (np. dwóch konsumentów):
$X = x_1 + x_2 = \left( - \frac{\partial a_1 / \partial p_n}{b(p)} - \frac{\partial b / \partial p_n}{b(p)} w_1 \right) + \left( - \frac{\partial a_2 / \partial p_n}{b(p)} - \frac{\partial b / \partial p_n}{b(p)} w_2 \right)$

Po przegrupowaniu:
$X = \underbrace{\left( - \frac{\partial a_1 / \partial p_n + \partial a_2 / \partial p_n}{b(p)} \right)}_{A(p)} - \underbrace{\left( \frac{\partial b / \partial p_n}{b(p)} \right)}_{B(p)} \cdot (w_1 + w_2)$

Ostatecznie, zagregowany popyt $X$ ma postać $X = A(p) + B(p) \cdot W$, gdzie $W = w_1 + w_2$. Dowodzi to, że zagregowany popyt **sam ma formę Gormana** i zależy **wyłącznie od zagregowanego dochodu $W$**, a nie od jego dystrybucji.

---

## 4. Agregacja, Aksjomaty i Modele Popytowe

### Reprezentatywny Konsument
* Zagregowany popyt **nie musi spełniać Słabego Aksjomatu Ujawnionych Preferencji (WA)**, nawet jeśli wszyscy konsumenci indywidualnie go spełniają.
* Warunkiem wystarczającym dla istnienia "pozytywnego reprezentatywnego konsumenta" (tj. sytuacji, gdy popyt rynkowy $X(p,W)$ zachowuje się tak, jakby był generowany przez jakąś racjonalną relację preferencji) jest spełnienie przez $X(p,W)$ Słabego Aksjomatu.
* Istnieje ścieżka do spełnienia WA: Jeśli preferencje indywidualne są **homotetyczne**, to spełniają one **Nieskompensowane Prawo Popytu (ULD)**. Jeśli popyt indywidualny spełnia ULD, to zagregowany popyt (przy stałych udziałach w dochodzie) również spełnia ULD, a to z kolei implikuje spełnienie WA.

### Wprowadzenie do Systemów Popytowych
Wykład krótko przedstawia dwa fundamentalne modele służące do empirycznego szacowania systemów popytu.

**1. Model Stone’a (LES – Linear Expenditure Systems, 1954)** 
* **Koncepcja:** Konsument najpierw wydaje dochód na minimalny, "zobowiązany" koszyk dóbr $\bar{q}$. Pozostały dochód (tzw. dochód "ponadminimalny" lub "supernumerary income" $\mu - \sum p_j \bar{q}_j$) jest następnie rozdzielany w stałych proporcjach $b_i$ na wszystkie dobra.
* **Właściwości:** Model ten jest zgodny z teorią: spełnia warunki addytywności, jednorodności i symetrii macierzy substytucji.

**2. Model Deatona-Muellbauera (AIDS – Almost Ideal Demand System, 1980)**
* **Koncepcja:** Bardziej elastyczny model, wywodzący się ze specyficznej klasy funkcji wydatków PIGLOG.
* **Zalety:** Pozwala na modelowanie **nieliniowych krzywych Engela**, co jest bardziej realistyczne (np. udział wydatków na żywność maleje wraz ze wzrostem dochodu).
* **Postać estymowana (w udziałach $s_i$):**
    $s_i = \alpha_i + \sum_j \gamma_{ij} \ln(p_j) + \beta_i \ln(m/P)$
    gdzie $s_i$ to udział wydatków na dobro $i$, $p_j$ to ceny, a $m/P$ to realny dochód (całkowite wydatki $m$ podzielone przez agregatowy indeks cen $P$).
* **Zgodność z teorią:** AIDS pozwala na łatwe testowanie i narzucanie ograniczeń teoretycznych poprzez proste restrykcje liniowe na parametry:
    * **Addytywność (sumowanie do 1):** $\sum_i \alpha_i = 1$, $\sum_i \beta_i = 0$, $\sum_i \gamma_{ij} = 0$.
    * **Jednorodność (brak iluzji pieniądza):** $\sum_j \gamma_{ij} = 0$ (dla każdego $i$).
    * **Symetria (Slutsky'ego):** $\gamma_{ij} = \gamma_{ji}$.

---

# Ćwiczenia

Na zajęciach wykorzystano język R do demonstracji estymacji systemów równań, w szczególności systemów popytowych.

## Pakiety

Podczas ćwiczeń korzystano z następujących głównych pakietów R:

* **`systemfit`**: Używany do estymacji systemów równań jednoczesnych, zwłaszcza metodą SUR (Seemingly Unrelated Regression). Prowadząca wspomniała, że ten pakiet będzie szczegółowo omawiany (do estymacji SUR) na kolejnych zajęciach.
* **`micEconAids`**: Główny pakiet użyty tego dnia, służący do analizy popytu i estymacji Prawie Doskonałego Systemu Popytowego (AIDS).
* **`plm`**: Pakiet do obsługi danych panelowych, który został załadowany, m.in. w kontekście demonstracji działania `systemfit` na danych panelowych.

---

## Przebieg ćwiczeń (Cele)

Ćwiczenia miały na celu zademonstrowanie praktycznej estymacji modeli ekonometrycznych w R.

### 1. Estymacja SUR (Seemingly Unrelated Regression)

Wykorzystano pakiet **`systemfit`** do estymacji metodą SUR.

* **Dane:** Użyto wbudowanego zbioru `Kmenta`.
* **Cel:** Pokazano, jak zdefiniować system dwóch równań (`konsumpcja` i `cena`), a następnie estymować go najpierw metodą OLS (MNK), a potem metodą SUR, aby porównać wyniki.
* **Dane panelowe:** Pokazano również krótko przykład użycia `systemfit` (metodą SUR) na danych panelowych `GrunfeldGreene`.
* **Ograniczenia:** Zademonstrowano także, jak nakładać ograniczenia liniowe na parametry (`restrict.matrix`) oraz jak je testować (`linearHypothesis`).

### 2. Estymacja systemu popytowego AIDS

Wykorzystano pakiet **`micEconAids`** do estymacji Prawie Doskonałego Systemu Popytowego (AIDS).

* **Dane:** Użyto wbudowanego zbioru `Blanciforti86`.
* **Cel:** Głównym celem było oszacowanie modelu popytu.
* **Kroki:**
    * Użyto funkcji `aidsEst` do oszacowania modelu, podając ceny (np. `pFood1`...`pFood4`), udziały w wydatkach (np. `wFood1`...`wFood4`) oraz całkowite wydatki (`xFoodNew`).
    * Pokazano, jak modyfikować model, np. wyłączając założenia teoretyczne (symetrię `sym=FALSE`, jednorodność `hom=FALSE`).
    * Zademonstrowano dodanie zmiennych dodatkowych ("shifters"), np. zmiennej trendu, do modelu (`shifterNames="trend"`).
    * Wskazano na funkcję `checkConsist` do sprawdzania zgodności modelu z teorią.
    * Pokazano, jak obliczyć elastyczności popytowe (cenowe i dochodowe) za pomocą funkcji `aidsElas`, wykorzystując do tego np. średnie udziały w wydatkach.